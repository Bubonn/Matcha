{"ast":null,"code":"var _jsxFileName = \"/Users/jb/projets/my_matcha/frontend/src/components/UserInfo/UserInfo.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { Outlet, useNavigate } from 'react-router-dom';\nimport { BackApi } from \"../../api/back\";\nimport { getCookieByName, parseJwt } from \"../../utils/auth\";\nimport { useSelector } from \"react-redux\";\nimport { useDispatch } from \"react-redux\";\nimport { saveId } from \"../../store/user/user-slice\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function UserInfo() {\n  _s();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const selector = useSelector(store => store.user.user);\n  const [jwt, setJwt] = useState(null);\n  async function checkToken() {\n    const token = getCookieByName('token');\n    if (!token) {\n      navigate('/signin');\n    } else {\n      const rep = await BackApi.checkToken(token);\n      if (rep.status !== 200) {\n        navigate('/signin');\n      } else {\n        let id;\n        if (selector.id === 0) {\n          id = parseJwt(token).userId;\n          dispatch(saveId(id));\n        }\n        setJwt(token);\n        let response;\n        if (selector.id === 0) {\n          response = await BackApi.getUserById(id, token);\n        } else {\n          response = await BackApi.getUserById(selector.id, token);\n        }\n        if (response.status === 200) {\n          const user = response.data;\n          console.log('OK');\n          if (user.all_infos_set && !user.verify) {\n            navigate('/verifyAccount');\n          } else if (user.all_infos_set) {\n            navigate('/search');\n          } else if (user.birth === null) {\n            navigate('/age');\n          } else if (!user.gender) {\n            navigate('/gender');\n          } else if (!user.preference) {\n            navigate('/preference');\n          } else if (!user.description) {\n            navigate('/description');\n          } else if (user.interests.length === 0) {\n            navigate('/interests');\n          } else if (!user.photo1) {\n            navigate('/mainPhoto');\n          } else {\n            navigate('/additionalsPhoto');\n          }\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    checkToken();\n    // eslint-disable-next-line\n  }, []);\n  if (!jwt) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 4\n    }, this)\n  }, void 0, false);\n}\n_s(UserInfo, \"lIHmPkDsZCHBXxRHYsWkL1oP/jI=\", false, function () {\n  return [useNavigate, useDispatch, useSelector];\n});\n_c = UserInfo;\nvar _c;\n$RefreshReg$(_c, \"UserInfo\");","map":{"version":3,"names":["useEffect","useState","Outlet","useNavigate","BackApi","getCookieByName","parseJwt","useSelector","useDispatch","saveId","Fragment","_Fragment","jsxDEV","_jsxDEV","UserInfo","_s","navigate","dispatch","selector","store","user","jwt","setJwt","checkToken","token","rep","status","id","userId","response","getUserById","data","console","log","all_infos_set","verify","birth","gender","preference","description","interests","length","photo1","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/jb/projets/my_matcha/frontend/src/components/UserInfo/UserInfo.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { Outlet, useNavigate } from 'react-router-dom';\nimport { BackApi } from \"../../api/back\";\nimport { getCookieByName, parseJwt } from \"../../utils/auth\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"../../store\";\nimport { useDispatch } from \"react-redux\";\nimport { saveId } from \"../../store/user/user-slice\";\n\nexport function UserInfo() {\n\n\tconst navigate = useNavigate();\n\tconst dispatch = useDispatch();\n\tconst selector = useSelector((store: RootState) => store.user.user);\n\tconst [jwt, setJwt] = useState<string | null>(null);\n\n\tasync function checkToken() {\n\t\tconst token: string | null = getCookieByName('token');\n\t\tif (!token) {\n\t\t\tnavigate('/signin');\n\t\t} else {\n\t\t\tconst rep = await BackApi.checkToken(token);\n\t\t\tif (rep.status !== 200) {\n\t\t\t\tnavigate('/signin');\n\t\t\t} else {\n\t\t\t\tlet id;\n\t\t\t\tif (selector.id === 0) {\n\t\t\t\t\tid = parseJwt(token).userId;\n\t\t\t\t\tdispatch(saveId(id));\n\t\t\t\t}\n\t\t\t\tsetJwt(token);\n\t\t\t\tlet response;\n\t\t\t\tif (selector.id === 0) {\n\t\t\t\t\tresponse = await BackApi.getUserById(id, token);\n\t\t\t\t} else {\n\t\t\t\t\tresponse = await BackApi.getUserById(selector.id, token);\n\t\t\t\t}\n\t\t\t\tif (response.status === 200) {\n\t\t\t\t\tconst user = response.data;\n\t\t\t\t\tconsole.log('OK');\n\n\t\t\t\t\tif (user.all_infos_set && !user.verify) {\n\t\t\t\t\t\tnavigate('/verifyAccount');\n\t\t\t\t\t} else if (user.all_infos_set) {\n\t\t\t\t\t\tnavigate('/search');\n\t\t\t\t\t} else if (user.birth === null) {\n\t\t\t\t\t\tnavigate('/age');\n\t\t\t\t\t} else if (!user.gender) {\n\t\t\t\t\t\tnavigate('/gender');\n\t\t\t\t\t} else if (!user.preference) {\n\t\t\t\t\t\tnavigate('/preference');\n\t\t\t\t\t} else if (!user.description) {\n\t\t\t\t\t\tnavigate('/description');\n\t\t\t\t\t} else if (user.interests.length === 0) {\n\t\t\t\t\t\tnavigate('/interests');\n\t\t\t\t\t} else if (!user.photo1) {\n\t\t\t\t\t\tnavigate('/mainPhoto');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavigate('/additionalsPhoto');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\tcheckToken();\n\t\t// eslint-disable-next-line\n\t}, [])\n\n\tif (!jwt) {\n\t\treturn (\n\t\t\t<>\n\t\t\t</>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Outlet />\n\t\t</>\n\t);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}